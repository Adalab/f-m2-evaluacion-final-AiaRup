"use strict";const searchButton=document.querySelector(".form__button"),searchInput=document.querySelector(".form__input"),seriesList=document.querySelector(".series"),favoritiesList=document.querySelector(".series__favorities");let favoriteSeries=[];const changeSeriesArray=(e,t)=>{const a=favoriteSeries.filter(e=>e.id===parseInt(t));a.length?favoriteSeries.splice(favoriteSeries.indexOf(a),1):favoriteSeries.push(e),saveStorageData(favoriteSeries),paintFavorities(favoriteSeries)},showObject=(e,t,a)=>({name:e,image:t,id:a});function saveStorageData(e){localStorage.setItem("favoriteShows",JSON.stringify(e))}function getStorageData(e){return JSON.parse(localStorage.getItem(e))}function removeStorageData(e){localStorage.removeItem(e)}function showOnClick(e,t){const{currentTarget:a}=e;a.classList.toggle("favorite");const s=a.dataset.id;changeSeriesArray(t,s)}function deleteFavorite(e){const t=favoriteSeries.findIndex(t=>t.id===parseInt(e));console.log("index",t),favoriteSeries.splice(t,1),paintFavorities(favoriteSeries),removeStorageData("favoriteShows"),saveStorageData(favoriteSeries)}const apiUrl="http://api.tvmaze.com/search/shows?q=",defaultImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",takeUserInput=()=>{const e={text:searchInput.value,status:!0};return e.text||(e.status=!1),e},checkImage=e=>e?e.medium:defaultImage,showSeries=({show:e})=>{let{image:t,name:a,id:s}=e;t=checkImage(t);const i=document.createElement("li");i.classList.add("show"),i.setAttribute("data-id",s);const r=document.createElement("div"),o=document.createElement("img");r.classList.add("show__image"),o.setAttribute("alt",a),o.setAttribute("src",t),o.classList.add("show__image-fake"),r.setAttribute("style",`background-image:url('${t}')`);const n=document.createElement("h2");n.classList.add("show__title");const c=document.createTextNode(a);n.appendChild(c),i.appendChild(n),i.appendChild(r);const d=showObject(a,t,s);i.addEventListener("click",e=>{showOnClick(e,d)}),seriesList.appendChild(i)},searchSeries=e=>{const t=takeUserInput();t.status&&fetch(`${e}${t.text}`).then(e=>e.json()).then(e=>{seriesList.innerHTML="";for(const t of e)showSeries(t)})};function paintFavorities(e){favoritiesList.innerHTML="";for(const t of e){const{id:e,image:a,name:s}=t,i=document.createElement("li");i.classList.add("show__favorite"),i.setAttribute("data-id",e);const r=document.createElement("div"),o=document.createElement("img");r.classList.add("favorite__image"),o.setAttribute("alt",s),o.setAttribute("src",a),o.classList.add("favorite__image-fake"),r.setAttribute("style",`background-image:url('${a}')`);const n=document.createElement("h2");n.classList.add("favorite__title");const c=document.createTextNode(s);n.appendChild(c);const d=document.createElement("div");d.classList.add("favorite__delete-icon");const l=document.createTextNode("x");d.appendChild(l),d.addEventListener("click",()=>{deleteFavorite(e)}),i.appendChild(n),i.appendChild(r),i.appendChild(d),favoritiesList.appendChild(i)}}searchButton.addEventListener("click",()=>{searchSeries(apiUrl)});const loadFavorites=()=>{favoriteSeries=[];const e=getStorageData("favoriteShows");e&&(favoriteSeries=e,paintFavorities(e))};loadFavorites();